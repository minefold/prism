#!/usr/bin/env ruby
# encoding: UTF-8
require 'bundler/setup'
Bundler.require :default, :proxy

$:.unshift File.join File.dirname(__FILE__), '../lib'
require 'minefold'
require 'prism'

STDOUT.sync = true
EM.epoll

module Prism
  EM.run do
    puts "Initialising"
    redis = EM::Hiredis.connect
    redis.callback do
      redis.del("prism:active_connections") do
        EM.start_server '0.0.0.0', 25565, Client

        puts "#{Fold.env} mode. listening on 0.0.0.0:25565"
      end
    end
  end
end
